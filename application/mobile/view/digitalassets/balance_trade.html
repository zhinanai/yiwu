{extend name="base"/}
{block name="title"}
    交易
{/block}
{block name="css"}
<link rel="stylesheet" href="__MOBILE__/css/meCen.css"/>
<link rel="stylesheet" href="__MOBILE__/css/fanStyle.css"/>
<link rel="stylesheet" href="__MOBILE__/js/layui/css/layui.css"/>

{/block}

{block name="content"}
	
	<div class="header">
	    <div class="header_l">
	    <a href="{:url('/mobile/Digitalassets/index')}"><img src="__MOBILE__/images/jiant.png" alt=""></a>
	    </div>

      
	    <div class="header_c" id="dig_xiala"><h2  style="line-height:36px;">{$coindets.coin_name}</h2> <p id="a"></p>
        <div id="dig_xiala_xs">
          <div class="downa">
              <ul>
                  <li><a href="{:url('/mobile/Digitalassets/balance_trade',['cid'=>1])}">易物币</a></li>
                  <li><a href="{:url('/mobile/Digitalassets/balance_trade',['cid'=>2])}">比特币</a></li>
                  <li><a href="{:url('/mobile/Digitalassets/balance_trade',['cid'=>3])}">莱特币</a></li>
                  <li><a href="{:url('/mobile/Digitalassets/balance_trade',['cid'=>4])}">以太坊</a></li>
                  <li class="off"><a href="{:url('/mobile/Digitalassets/balance_trade',['cid'=>5])}">狗狗币</a></li>
              </ul>
          </div>
          <div class="reveal-modal-bg"></div>
        </div>
	    </div>
	    <div class="header_r"></div>
	</div>

    <div class="big_width100">
	    <div class="big_width100">
	    <div class="buy_Wpayzu clear_wl">
	     	  <div class="buy_Wpayzu_l">
          <p>{$coindets.coin_name}</p>
          <p>{$myassets.c_nums ?? '0.0000'}</p>
         </div>
         <div class="buy_Wpayzu_l">
          <p>{:lang('余额')}</p>
          <p>{$wallet.wallet_num}</p>
         </div>

	     	 <div class="buy_Wpayzu_z"></div>

     </div>

     <div class="buy_inde_dangq">
     	<ul class="clear_wl">
     		<li> <p><span>{:lang('当前价格')}</span>{$coindets.coin_price}</p></li>
     		<li> <p><span>{:lang('高')}</span>{$coindets.coin_price}<img src="__MOBILE__/images/buy_bie.png"></p></li>
     		<li> <p><span>{:lang('低')}</span>{$coindets.coin_price} <img src="__MOBILE__/images/buy_jiang.png"></p></li>
     	</ul>
     </div>

     <div class="wpzicicon_buy">
	    		<ul class="clear_wl">
	    			<li>
	    				<a href="{:url('/mobile/Digitalassets/tran_salesell')}">
	    					<img src="__MOBILE__/images/jiaoy01-iocn.png" alt="">
	    					<p>{:lang('发布出售订单')}</p>
	    				</a>
	    			</li>
	    			<li>
	    				<a href="{:url('/mobile/Digitalassets/tran_salebuy')}">
	    					<img src="__MOBILE__/images/jiaoy02-iocn.png" alt="">
	    					<p>{:lang('发布购买订单')}</p>
	    				</a>
	    			</li>
	    			<li>
	    				<a href="{:url('/mobile/Digitalassets/tran_orderinfos')}">
	    					<img src="__MOBILE__/images/jiaoy03-iocn.png" alt="">
	    					<p>{:lang('订单')}</p>
	    				</a>
	    			</li>
	    			<li>
	    				<a href="{:url('/mobile/Digitalassets/tran_dealrecords')}">
	    					<img src="__MOBILE__/images/jiao04-iocn.png" alt="">
	    					<p>{:lang('交易记录')}</p>
	    				</a>
	    			</li>
	    		</ul>
	   </div>

<style type="text/css">
  .highcharts-credits{
    display: none;
  }
</style>


 <div class="buy_quexiant">		   
			   <ul class="clear_wl">
			   	  <li id="s1" onclick="cont1();" class="yon">{:lang('一小时')}</li>
			   	  <li id="s2"  onclick="cont2();" class="">{:lang('五小时')}</li>
			   	  <li id="s3"  onclick="cont3();" class="">{:lang('日线')}</li>
			   </ul>

	</div>
<div id="container1"  style="width:100%; height: 300px;margin-top: .2rem;"></div>
<div id="container2"  style="display:none;width:100%; height: 300px; margin-top: .2rem; "></div>
<div id="container3"  style="display:none;width:100%; height: 300px; margin-top: .2rem;"></div>

	  <div class="investment_f">
      <div class="investment_title">
        <div  class="on"> 
          <a href="">{:lang('购买')}</a>
        </div>
        <div><a href="">{:lang('出售')}</a></div>
      </div>
      <div class="investment_con">
        <div class="investment_con_list">
          <ul class="buy_gaomai">
            <foreach name="deals" item="v" key="k" >
            <li>
              <div class="buy_li_gol">
                <img src="{$v['d_img_head']|default='__MOBILE__/images/toux-icon.png'}">
                <div class="li_gop">
                  <p>123</p>
                  <p><span>{:lang('限额')}：123</span></p>
                </div>
              </div>
              <div class="buy_li_gor">
                <p>$123</p>
                <a href="javascript:void(0);" class="ljzf_but " onclick="">{:lang('购买')}</a>
              </div>
            </li>
            </foreach>
          </ul>
        </div>
      </div>
    </div>
	 </div>	 
 

  <!--浮动层-->
		    <div class="ftc_wzsf" >
		        <div class="srzfmm_box">
		            <div class="qsrzfmm_bt clear_wl">
		                <img src="__MOBILE__/images/xx_03.jpg" class="tx close fl">
		               <input type="hidden" id="dealid">
		                <span class="fl goumaiduix">{:lang('向')}[情动之初]{:lang('购买')}<br/>Wpeay</span></div>
		            <div class="zfmmxx_shop">
		                <div class="xiange_titel">
		                	<p class="xe_pl">{:lang('限 额')}：<span class="limit">3.1551</span></p>
		                	<p class="xe_pr">123</p>
		                </div>
                        <center><form> 
		                  <div class="xiange_titel xiange_titela">
		                	<p class="xe_pl" >{:lang('价格')}：</p>
		                	<input type="number" size="40" name="Data"  id="dprice" onkeyup="enfocus()" readonly="readonly" value="0" class="jiaoyjis" >
		                	
		                </div>
		                 <div class="xiange_titel">
		                	<p class="xe_pl">{:lang('数')}：</p>
		                	<input type="number" size="40" name="Data2"   oninput="checkNum(this)"  id="num" onkeyup="enfocus()" class="jiaoyjis livalue" value="" onkeyup="value=value.replace(/[^\d]/g,'')" placeholder="{:lang('请输入数量')}">
		                	<a href="#" class="xe_pl_a">{:lang('全额')}</a>
		                </div>

		                  <div class="xiange_titel">
		                	<p class="xe_pl">{:lang('余 额')}：</p>
		                	<input type="number" size="40" name="Copy"   onkeyup="enfocus()"  readonly="readonly" id="copy" class="jiaoyjis"> 
		                	
		                </div>
		            </form></center> 
		            </div>
		            <ul class="mm_box">
		                <li></li><li></li><li></li><li></li><li></li><li></li>
		            </ul>
		        </div>
		        <div class="numb_box">
		            <div class="xiaq_tb">
		                <img src="__MOBILE__/images/jftc_14.jpg" height="10"></div>
		            <ul class="nub_ggg">
		                <li><a href="javascript:void(0);" class="zf_num">1</a></li>
		                <li><a href="javascript:void(0);" class="zj_x zf_num">2</a></li>
		                <li><a href="javascript:void(0);" class="zf_num">3</a></li>
		                <li><a href="javascript:void(0);" class="zf_num">4</a></li>
		                <li><a href="javascript:void(0);" class="zj_x zf_num">5</a></li>
		                <li><a href="javascript:void(0);" class="zf_num">6</a></li>
		                <li><a href="javascript:void(0);" class="zf_num">7</a></li>
		                <li><a href="javascript:void(0);" class="zj_x zf_num">8</a></li>
		                <li><a href="javascript:void(0);" class="zf_num">9</a></li>
		                <li><a href="javascript:void(0);" class="zf_empty">{:lang('清空')}</a></li>
		                <li><a href="javascript:void(0);" class="zj_x zf_num">0</a></li>
		                <li><a href="javascript:void(0);" class="zf_del">{:lang('删除')}</a></li>
		            </ul>
		        </div>
		        <div class="hbbj"></div>
		    </div>

{/block}
{block name="js"}
<script type="text/javascript" src="__MOBILE__/js/highcharts.js"></script>
<script type="text/javascript" src="__MOBILE__/js/crowds.js"></script>

<script type="text/javascript">
Highcharts.chart('container1', {
  chart: {
    type: 'area'
  },
  title: {
    text: ''
  },
  subtitle: {
    text: ''
  },
  xAxis: {
    allowDecimals: false,
    labels:{
      formatter: function () {
        return (5-this.value)*12 +'{:lang("分钟前")}'; // clean, unformatted number for year
      },
    }
  },
  yAxis: {
    title: {
      text: ''
    },
    max:0.6000, // 定义Y轴 最大值  
    min:0.1000, // 定义最小值  
    tickInterval:0.01, // 刻度值  
  },
  tooltip: {
    pointFormat: '{:lang("当前值")}：{point.y}'
  },
  plotOptions: {
    area: {
      pointStart: 1,
      marker: {
        enabled: false,
        symbol: 'circle',
        radius: 2,
        states: {
          hover: {
            enabled: true
          }
        }
      }
    }
  },
  series: [{
      name: '时间',
      data: [
        0.4000,0.2000,0.3000,0.2000,0.6000   
      ]
    }]
});


Highcharts.chart('container2', {
  chart: {
    type: 'area'
  },
  title: {
    text: ''
  },
  subtitle: {
    text: ''
  },
  xAxis: {
    allowDecimals: false,
    labels: {
      formatter: function () {
        return (5-this.value) +'{:lang("小时前")}';; // clean, unformatted number for year
      },
       
    }
  },
  yAxis: {
    title: {
      text: ''
    },
    max:0.6000, // 定义Y轴 最大值  
    min:0.1000, // 定义最小值  
 
    tickInterval:0.01, // 刻度值  
  },
  tooltip: {
    pointFormat: '{:lang("当前值")}：{point.y}'
  },
  plotOptions: {
    area: {
      pointStart: 1,
      marker: {
        enabled: false,
        symbol: 'circle',
        radius: 2,
        states: {
          hover: {
            enabled: true
          }
        }
      }
    }
  },
  series: [{
    name: '{:lang("时间")}',
    data: [
        0.3000,0.6000,0.5000,0.3000,0.5000   
      ]
  }, ]
});



Highcharts.chart('container3', {
  chart: {
    type: 'column'
  },
  title: {
    text: ''
  },
  xAxis: {
    categories: ['0', '1', '2', '3', '4', '5', '6', '7', '9', '10', '11', '12', '13', '14', '15', '16', '17','18', '19', '20', '21', '22','23',]
  },
  credits: {
    enabled: false
  },
  series: [{
    name: '{:lang("价格增幅")}',
    data: [0.3000,0.5,1.2,0.8000,0,0,1.4,0.8,0.5,0.6,1.5,0,0.6,0.7,0.2,0]
  }]
});

</script>



<script type="text/javascript">
  
    $(document).ready(function(){ 
    // 　　  $('.highcharts-legend').remove('g');
    // $('highcharts-background').css('height','20vmin');
    }); 

    $('.xe_pl_a').click(function(){
      var limitvalue = $('.limit').text();
      $('.livalue').val(limitvalue);
      enfocus();
    })


    function enfocus() 
    { 
        var t1 = document.forms[0].Data.value; 
        var t2 = document.forms[0].Data2.value; 
        var t3 = document.forms[0].Copy.value ; 
        if(t1!="" && t2!=""){ 
          var floatValue = parseFloat(t1) * parseFloat(t2);
          document.getElementById("copy").value = floatValue.toFixed(4) ;  
        } 
        else {
          document.getElementById("copy").value = "";
        } 
    } 


    $(document).ready(function(){
        $("#dig_xiala").click(function(){
          $("#dig_xiala_xs").toggle(); //toggle() 方法切换元素的可见状态。 如果被选元素可见,则隐藏这些元素,如果被选元素隐藏,则显示这些元素。
        });	 
    });


      //限制number  输入格式
      function checkNum(obj){

        obj.value = obj.value.replace(/^(\-)*(\d+)\.(\d\d\d\d).*$/,'$1$2.$3');//只能输入三个小数.(\d\d\d) 修改个数  加\d
      }

      function gbzhi(s1,s2,s3,s4) 
      { 

          $(".limit").text(s1);
          $(".goumaiduix").html("{:lang('向')}["+s3+"]{:lang('购买')}<br>123");
          $("#dprice").val(s2);	
          $("#dealid").val(s4);	
          $(".ftc_wzsf").show();                  
      }
      function cont1(){
        $("#container2").hide();
        $("#container3").hide();
        $("#container1").show();
        $("#s2").removeClass("yon");
        $("#s1").addClass("yon");
        $("#s3").removeClass("yon");
      }

      function cont2(){
        $("#container1").hide();
        $("#container3").hide();
        $("#container2").show();
        $("#s1").removeClass("yon");
        $("#s2").addClass("yon");
        $("#s3").removeClass("yon");
      }


      function cont3(){
        $("#container1").hide();
        $("#container2").hide();
        $("#container3").show();
        $("#s2").removeClass("yon");
        $("#s3").addClass("yon");
        $("#s1").removeClass("yon");
      }

      $(function(){
          //出现浮动层
          // $(".ljzf_but").click(function(){
          //     $(".ftc_wzsf").show();
          // });
          $("#container2").hide();
          $("#container3").hide();

          //关闭浮动
          $(".close").click(function(){
              $(".ftc_wzsf").hide();
              $(".mm_box li").removeClass("mmdd");
              $(".mm_box li").attr("data","");
              i = 0;
          });

              //数字显示隐藏
          $(".xiaq_tb").click(function(){
              $(".numb_box").slideUp(500);
          });
          $(".mm_box").click(function(){
              $(".numb_box").slideDown(500);
          });
              //----
          var i = 0;
          post_flag = false;
          $(".nub_ggg li .zf_num").click(function(){

              if(i<6){
                  $(".mm_box li").eq(i).addClass("mmdd");
                  $(".mm_box li").eq(i).attr("data",$(this).text());                      
                  i++
                  if (i==6) {
                      var pwd = "";
                          $(".mm_box li").each(function(){
                          pwd += $(this).attr("data");
                      });
                    // alert("支付成功"+data);

                      if(post_flag) return; 
                      post_flag = true;
            
                      var dprice=($('#dprice').val());//支付单价
                      var tprice=($('#copy').val());//支付总价
                      var num = parseFloat($('#num').val());//数量
                      var dealid = parseInt($('#dealid').val());//订单ID
                      var cid = '易物币';//币的种类
                      var ss1=parseFloat($(".limit").text());			

                
                          $.ajax({
                              url:'/Turntable/yue_goumai',
                              asyn:false,
                              type:'post',
                              data:{'dprice':dprice,'num':num,'tprice':tprice,'cid':cid,'pwd':pwd,'ss1':ss1,'dealid':dealid},
                              datatype:'json',
                              success:function (mes) {
                                post_flag = false;
                              
                                  if(mes.status == 1){

                                    $(".ftc_wzsf").hide();
                                      msg_alert(mes.message,mes.url);
                                      
                                  }else{
                                      msg_alert(mes.message);
                                      
                                  }
                              },
                              error: function(){
                                post_flag =false; //AJAX失败也需要将标志标记为可提交状态
                              }
                          });
                  };
              } 
          });
              
          $(".nub_ggg li .zf_del").click(function(){
              if(i>0){
                  i--
                  $(".mm_box li").eq(i).removeClass("mmdd");
                  $(".mm_box li").eq(i).attr("data","");
              }
          });

          $(".nub_ggg li .zf_empty").click(function(){
              $(".mm_box li").removeClass("mmdd");
              $(".mm_box li").attr("data","");
              i = 0;
          });
          
      });
</script>

{/block}
